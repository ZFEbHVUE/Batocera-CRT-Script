# /etc/X11/xorg.conf.d/20-modesetting.conf
# Force the modesetting DDX for AMD GPUs, CRT-safe (15/25/31 kHz).
# TearFree/VRR are kept OFF to preserve direct KMS pageflips.
# (TearFree can insert a shadow framebuffer & blit path that blocks flips, adds latency,

Section "OutputClass"
    Identifier "AMD via modesetting (amdgpu)"
    MatchDriver "amdgpu"               # Match AMD kernel driver
    Driver "modesetting"               # Explicitly use modesetting DDX
    Option "TearFree" "false"          # Keep direct pageflips; avoid TearFree shadow-FB blitting
    Option "VariableRefresh" "false"   # VRR is irrelevant for fixed CRT timings
    # No DRI option → stays on DRI3 by default
EndSection

Section "OutputClass"
    Identifier "AMD via modesetting (radeon)"
    MatchDriver "radeon"               # Match AMD kernel driver
    Driver "modesetting"               # Explicitly use modesetting DDX
    Option "TearFree" "false"          # Keep direct pageflips; avoid TearFree shadow-FB blitting
    # No VariableRefresh here; not applicable with radeon
    # No DRI option → stays on DRI3 by default
EndSection